<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTC-8">
    <title>GifTastic</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet">
</head>

<body>

    <div class="container">
        <div id="buttonHeading" class="row">
            <div id="buttons" class="col-md-12"></div>
        </div>
        <br>
        <div class="row">
            <div id="gifs" class="col-md-9"></div>
            <div id="form" class="col-md-3">
                <p id="heading">Add a TV Show</p>
                <input id="newShow" type="text">
                <br>
                <br>
                <button id="submit" type="button" class="btn btn-default">Submit</button>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        var topics = ["Fresh Prince", "Game of Thrones", "Friends", "Parks and Rec", "New Girl", "Brooklyn99", "Silicon Valley", "Grace and Frankie", "How I Met Your Mother", "Westworld", "Stranger Things",
            "This Is Us", "Entourage", "Seinfeld", "The Simpsons", "Family Matters", "That 70's Show", "Outlander", "The Walking Dead", "Big Little Lies", "Big Bang Theory"
        ];

        function renderButtons() {
            $("#buttons").empty();
            for (var i = 0; i < topics.length; i++) {
                var noSpaces = topics[i].replace(/ /g, '+');
                $("#buttons").append('<button type="button" class="btn btn-default tvButton" data-title=' + noSpaces + '>' + topics[i] + '</button>');
                console.log(noSpaces);
            }


            $(".tvButton").on("click", function() {
                $("#gifs").empty();
                var tvShow = $(this).attr("data-title");
                var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + tvShow + "&api_key=YnovwKA47pASDe8JvModnuNKkkGiz1CC&limit=10&rating=pg";
                // console.log(tvShow);

                $.ajax({ url: queryURL, method: "GET" })

                    .done(function(response) {
                        var results = response.data;

                        for (var i = 0; i < results.length; i++) {

                            var gifDiv = $("#gifs");
                            var itemDiv = $("<div class='col-md-3'>")
                            var rating = results[i].rating;
                            var p = $("<p>").text("Rating: " + rating);

                            var tvGif = $('<img class="gifImage" data-state="still">');
                            tvGif.attr("src", results[i].images.fixed_height_small_still.url);
                            tvGif.attr("data-animate", results[i].images.fixed_height_small_still.url);
                            tvGif.attr("data-still", results[i].images.fixed_height_small_still.url);

                            itemDiv.append(tvGif);
                            itemDiv.append(p);
                            gifDiv.prepend(itemDiv);

                        }

                    });

            });

        }

        renderButtons();

        $(document.body).on("click", ".gifImage", function() {
            var state = $(this).attr('data-state');

            if (state === 'still') {
                $(this).attr("src", $(this).attr("data-animate"));
                $(this).attr("data-state", "animate");
            }

            else if (state === 'animate') {
                $(this).attr("src", $(this).attr("data-still"));
                $(this).attr("data-state", "still");
            }

        });

        $("#submit").on("click", function(event) {
            event.preventDefault();
            var newButton = $("#newShow").val();
            topics.push(newButton);
            renderButtons();
            $("#newShow").val("");
        });
    </script>


</body>

</html>
